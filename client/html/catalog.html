<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KHAI MEAOW</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Paytone+One&family=Prompt:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/universalstyle.css">
    <link rel="stylesheet" href="/catalog.css">
    <link rel="stylesheet" href="/moreBG.css">
    <link rel="icon" type="image/png" href="/img/logokhaimeaow.svg">
    
</head>

<body>
    <!-- Navbar -->
    <header class="navbar">
        <div class="logo">
            <a href="/home"><img src="/img/logokhaimeaow.svg" alt="Logo"></a>
            </div>
            <nav>
                <ul>
                    <li><a href="/catalog">Catalog</a></li>
                    <li><a href="/contact">Contact</a></li>
                    <li><a href="/search/page" class="search"><img src="/img/icon-search.svg" alt="Search"></a></li>
                    <li><a href="/acc" class="search"><img src="/img/account-circle-svgrepo-com.svg"></a></li>
                </ul>
            </nav>
        </header>

    <!-- Background -->
    <div class="ellipse"></div>
    <div class="bgContainer">
        <section class="catalog" id="catalogSection">
        </section>
    </div>
    <script>
        const catalogSection = document.querySelector("#catalogSection");
        const url = "http://localhost:8080/catalog/data";
        const imageurl = "http://localhost:8080/img/";

        async function loadCatalog() {
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error("Failed to fetch catalog data");

                const data = await response.json();
                const cats = data.results || data;

                // Available only
                const availableCats = cats.filter(cat => cat.CatStatus === "Available");

                // จัดกลุ่มตาม breed
                const breeds = {};
                availableCats.forEach(cat => {
                    if (!breeds[cat.CatBreed]) breeds[cat.CatBreed] = [];
                    breeds[cat.CatBreed].push(cat);
                });

                for (const breed in breeds) {
                    const h1 = document.createElement("h1");
                    h1.textContent = breed;
                    catalogSection.appendChild(h1);

                    const catbox = document.createElement("div");
                    catbox.classList.add("catbox");

                    breeds[breed].forEach(cat => {
                        const card = document.createElement("div");
                        card.classList.add("cat-grid");
                        card.innerHTML = `
                                <img src="${imageurl}${cat.CatImg}" alt="${cat.CatName}">
                                <button class="button" onclick="window.location.href='${cat.CatDetailURL}'">ดูรายละเอียด</button>`;
                        catbox.appendChild(card);
                    });

                    catalogSection.appendChild(catbox);
                }

            } catch (err) {
                console.error(err);
                catalogSection.innerHTML = "Not found";
            }
        }
        loadCatalog();
    </script>


    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <h3>KHAI MEAOW CO, Ltd</h3>
            <h4>Contact</h4>
            <p>อาคาร ICT, มหาวิทยาลัยมหิดล, 999 Phutthamonthon Sai 4 Rd, Salaya,<br>
                Phutthamonthon District, Nakhon Pathom 73170</p>
            <p>Email: <a href="mailto:support.khaimeaow@gmail.com">support.khaimeaow@gmail.com</a><br>
                Tel: 0999999999<br>
                <a href="/acc">@Team Khaimeaow</a> 2025 All rights reserved.
            </p>
            <div class="social">
                <a href="https://www.instagram.com"><img src="/img/icon-instagram.svg" alt="Instagram"></a>
                <a href="https://www.facebook.com"><img src="/img/icon-facebook.svg" alt="Facebook"></a>
                <a href="https://www.tiktok.com"><img src="/img/icon-tiktok.svg" alt="TikTok"></a>
            </div>
        </div>
    </footer>
</body>

</html>